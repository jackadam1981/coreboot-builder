diff --git a/src/drivers/net/r8168.c b/src/drivers/net/r8168.c
index 8ef2ee8148..a9a1da13d1 100644
--- a/src/drivers/net/r8168.c
+++ b/src/drivers/net/r8168.c
@@ -117,7 +117,7 @@ static enum cb_err fetch_mac_vpd_key(u8 *macstrbuf, const char *vpd_key)
 	}
 	printk(BIOS_DEBUG, "Located '%s' in VPD\n", vpd_key);
 
-	offset += strlen(vpd_key) + 1;	/* move to next character */
+	offset += vpd[offset + 1] + 2;	/* move to next character */
 
 	if (offset + MACLEN > search_length) {
 		rdev_munmap(&rdev, search_address);
@@ -245,8 +245,12 @@ static void program_mac_address(struct device *dev, u16 io_base)
 	inl(io_base);
 	/* Some boards (e.g. asus/p8z77-v_le_plus) need the MAC address set here too */
 	if (CONFIG(RT8168_PUT_MAC_TO_ERI)) {
+		printk(BIOS_DEBUG, "r8168: Programming MAC to ERI registers...\n");
+		u8 revision = pci_read_config8(dev, PCI_REVISION_ID);
+		printk(BIOS_DEBUG, "r8168: Device revision ID: 0x%02x\n", revision);
 		switch (pci_read_config8(dev, PCI_REVISION_ID)) {
 		case 6:
+			printk(BIOS_DEBUG, "r8168: Programming ERI for RTL8168 revision 6\n");
 			outl((maclo & 0xffff) << 16, io_base + ERIDR);
 			inl(io_base + ERIDR);
 			outl(0x8000f0f0, io_base + ERIAR);
@@ -256,6 +260,7 @@ static void program_mac_address(struct device *dev, u16 io_base)
 			outl(0x8000f0f4, io_base + ERIAR);
 			break;
 		case 9:
+			printk(BIOS_DEBUG, "r8168: Programming ERI for RTL8168 revision 9\n");
 			outl(maclo, io_base + ERIDR);
 			inl(io_base + ERIDR);
 			outl(0x8000f0e0, io_base + ERIAR);
@@ -264,6 +269,21 @@ static void program_mac_address(struct device *dev, u16 io_base)
 			inl(io_base + ERIDR);
 			outl(0x800030e4, io_base + ERIAR);
 			break;
+		case 12:
+		case 13:
+		case 14:
+		case 15:
+			/* RTL8111H revision 12-15 ERI programming */
+			printk(BIOS_DEBUG, "r8168: Programming ERI for RTL8111H revision %d\n", revision);
+			outl(maclo, io_base + ERIDR);
+			inl(io_base + ERIDR);
+			outl(0x8000f0e0, io_base + ERIAR);
+			inl(io_base + ERIAR);
+			outl(machi, io_base + ERIDR);
+			inl(io_base + ERIDR);
+			outl(0x800030e4, io_base + ERIAR);
+			printk(BIOS_DEBUG, "r8168: ERI programming completed for RTL8111H\n");
+			break;
 		}
 		udelay(1000);
 	}
