--- a/src/drivers/net/r8168.c
+++ b/src/drivers/net/r8168.c
@@ -207,9 +207,19 @@
 	}
 
 	for (i = 0; i < 6; i++) {
-		macaddr[i] = 0;
-		macaddr[i] |= get_hex_digit(strbuf[offset]) << 4;
-		macaddr[i] |= get_hex_digit(strbuf[offset + 1]);
+		u8 hex1, hex2;
+		hex1 = get_hex_digit(strbuf[offset]);
+		hex2 = get_hex_digit(strbuf[offset + 1]);
+
+		/* Check if both hex digits are valid */
+		if (hex1 > 0x0f || hex2 > 0x0f) {
+			printk(BIOS_ERR, "r8168: Invalid hex digit in MAC address at position %d\n", i);
+			return;
+		}
+
+		macaddr[i] = (hex1 << 4) | hex2;
 		offset += 3;
 	}
+	printk(BIOS_DEBUG, "r8168: Parsed MAC address: %02x:%02x:%02x:%02x:%02x:%02x\n",
+	       macaddr[0], macaddr[1], macaddr[2], macaddr[3], macaddr[4], macaddr[5]);
 }
 
 static void program_mac_address(struct device *dev, u16 io_base)