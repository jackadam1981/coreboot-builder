name: æ–¹æ¡ˆ7 - Realtek 8111 PXE ROM é›†æˆ / Strategy 7 - RTL8111 PXE ROM Integration

on:
  # æ”¯æŒæ‰‹åŠ¨è§¦å‘
  workflow_dispatch:
    inputs:
      release:
        description: "åˆ›å»º Release å‘å¸ƒ / Create Release"
        required: false
        type: boolean
        default: false

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“‹ æ˜¾ç¤ºæ–¹æ¡ˆä¿¡æ¯ / Display Strategy Info
        run: |
          echo "=========================================="
          echo "ğŸ¯ æ–¹æ¡ˆ7ï¼šRealtek 8111 PXE ROM é›†æˆ"
          echo "=========================================="
          echo ""
          echo "ğŸ“ æ–¹æ¡ˆè¯´æ˜ï¼š"
          echo "  - ä½¿ç”¨ MrChromebox çš„ EDK2 ä½œä¸ºä¸»è¦ payload"
          echo "  - é›†æˆ iPXEï¼ˆå†…ç½® Realtek é©±åŠ¨ï¼‰ä½œä¸º PCI Option ROM"
          echo "  - âš ï¸  é‡è¦ï¼šRTL8111H æ²¡æœ‰å®˜æ–¹ PXE ROM"
          echo "  - ğŸ’¡ æ›¿ä»£æ–¹æ¡ˆï¼šä½¿ç”¨ iPXE å†…ç½® Realtek é©±åŠ¨"
          echo ""
          echo "ğŸ¯ é¢„æœŸç»“æœï¼š"
          echo "  âœ… ç¡¬ä»¶å±‚é¢å¯ç”¨ç½‘ç»œå¯åŠ¨"
          echo "  âœ… BIOS/UEFI è‡ªåŠ¨è¯†åˆ«ç½‘å¡çš„ PXE èƒ½åŠ›"
          echo "  âœ… æœ€ç®€å•ã€æœ€å¯é çš„é›†æˆæ–¹å¼"
          echo ""
          echo "ğŸ“Š æŠ€æœ¯å®ç°ï¼š"
          echo "  1. ä½¿ç”¨ä»“åº“ä¸­çš„ Realtek GBE PXE ROM Code 2.70"
          echo "  2. ç¼–è¯‘ MrChromebox å›ºä»¶ï¼ˆEDK2 payloadï¼‰"
          echo "  3. ä½¿ç”¨ cbfstool æ·»åŠ ä½œä¸º PCI Option ROM"
          echo "  4. PCI Vendor ID: 0x10ec, Device ID: 0x8168"
          echo ""
          echo "ğŸ’¡ æŠ€æœ¯ä¼˜åŠ¿ï¼š"
          echo "  â­ é›†æˆå¤æ‚åº¦æœ€ä½"
          echo "  â­ å®˜æ–¹ Realtek PXE ROM æ”¯æŒ"
          echo "  â­ ä¸ä¾èµ– EDK2 ç½‘ç»œæ ˆ"
          echo "  â­ å¯åŠ¨é€Ÿåº¦å¿«"
          echo "  â­ ä»“åº“é¢„ç½®æ–‡ä»¶ï¼Œæ— éœ€ä¸‹è½½"
          echo "=========================================="

      - name: æ£€å‡ºæ„å»ºä»“åº“ / Checkout Builder Repository
        uses: actions/checkout@v4

      - name: æ‹‰å– Coreboot SDK å®¹å™¨ / Pull Coreboot SDK
        run: docker pull coreboot/coreboot-sdk:latest

      - name: å…‹éš† MrChromebox Coreboot æºç  / Clone Coreboot Source
        run: |
          echo "ğŸ“¥ å…‹éš† MrChromebox coreboot"
          git clone https://github.com/MrChromebox/coreboot.git coreboot
          cd coreboot
          git submodule update --init --checkout --recursive

      - name: ğŸ“¦ æå– Realtek PXE ROM / Extract Realtek PXE ROM
        run: |
          echo "ğŸ“¦ æå– Realtek GBE PXE ROM Code 2.70"
          
          # åˆ›å»ºç›®å½•
          mkdir -p pxerom_files
          cd pxerom_files
          
          # è§£å‹å¹¶æå– PXE ROM
          unzip -q ../RTEGPXE.270.zip
          # å°è¯•ä½¿ç”¨ .lom æ–‡ä»¶ï¼ˆå¯èƒ½æ›´é€‚åˆ corebootï¼‰
          cp BIN/rtegpxe.lom gbe_pxe_rom_2.70.rom
          
          echo "âœ… PXE ROM æå–æˆåŠŸ"
          echo "ğŸ“Š æ–‡ä»¶å¤§å°ï¼š$(du -h gbe_pxe_rom_2.70.rom | cut -f1)"
          echo "ğŸ¯ PCI ID: 0x10ec:0x8168 (RTL8111H)"

      - name: æ›¿æ¢ Logo / Replace Logo
        run: |
          echo "ğŸ¨ æ›¿æ¢ coreboot å¯åŠ¨ Logo"
          cd coreboot
          if [ -f "Documentation/coreboot_logo.bmp" ]; then
            # åˆ›å»ºè‡ªå®šä¹‰ logoï¼ˆå¦‚æœä½ æœ‰çš„è¯ï¼Œå¯ä»¥ä»ä»“åº“å¤åˆ¶ï¼‰
            # è¿™é‡Œä½¿ç”¨é»˜è®¤ logo
            echo "âœ… ä½¿ç”¨é»˜è®¤ coreboot logo"
          fi

      - name: ğŸ“¦ ç¼–è¯‘ MrChromebox Coreboot å›ºä»¶ / Build Coreboot
        run: |
          echo "ğŸ”¨ ç¼–è¯‘ MrChromebox corebootï¼ˆkaisa ä¸»æ¿ï¼‰"
          docker run --rm --user root \
            -v "$(pwd)/coreboot:/home/coreboot/coreboot" \
            -v "$(pwd)/roms:/home/coreboot/roms" \
            -w /home/coreboot/coreboot \
            coreboot/coreboot-sdk:latest \
            bash -c "git config --global --add safe.directory /home/coreboot/coreboot && \
                     echo 'ğŸ”§ ä½¿ç”¨ MrChromebox build-uefi.sh ç¼–è¯‘ kaisa...' && \
                     ./build-uefi.sh kaisa && \
                     echo 'ğŸ“¦ ç¼–è¯‘å®Œæˆï¼ŒæŸ¥æ‰¾è¾“å‡ºæ–‡ä»¶...' && \
                     find ~/dev -name '*.rom' -type f 2>/dev/null | head -5 && \
                     find . -name '*.rom' -type f 2>/dev/null | head -5 && \
                     ROM_FILE=\$(find ~/dev -name '*.rom' -type f 2>/dev/null | head -1) && \
                     if [ -z \"\$ROM_FILE\" ]; then \
                       ROM_FILE=\$(find . -name '*.rom' -type f 2>/dev/null | head -1); \
                     fi && \
                     if [ -n \"\$ROM_FILE\" ]; then \
                       ROM_BASENAME=\"coreboot_edk2-kaisa-mrchromebox_\$(date +%Y%m%d).rom\" && \
                       cp \"\$ROM_FILE\" \"/home/coreboot/roms/\$ROM_BASENAME\" && \
                       chmod 644 /home/coreboot/roms/*.rom && \
                       echo \"âœ… ROM æ–‡ä»¶å·²å¤åˆ¶: /home/coreboot/roms/\$ROM_BASENAME\"; \
                     else \
                       echo 'âŒ æœªæ‰¾åˆ°ç¼–è¯‘ç”Ÿæˆçš„ ROM æ–‡ä»¶'; \
                       ls -la ~/dev/ 2>/dev/null || echo 'âš ï¸ ~/dev ç›®å½•ä¸å­˜åœ¨'; \
                       exit 1; \
                     fi"

      - name: ğŸ”§ é›†æˆ Realtek 8111 PXE ROM / Integrate RTL8111 PXE ROM
        run: |
          echo "ğŸ”§ å°† Realtek 8111 PXE ROM é›†æˆåˆ°å›ºä»¶ä¸­"
          
          # æŸ¥æ‰¾ç”Ÿæˆçš„ ROM æ–‡ä»¶
          ROM_FILE=$(ls roms/*.rom | head -1)
          if [ -z "$ROM_FILE" ]; then
            echo "âŒ æœªæ‰¾åˆ° ROM æ–‡ä»¶"
            echo "ğŸ“‹ æ£€æŸ¥ roms ç›®å½•å†…å®¹ï¼š"
            ls -la roms/ 2>/dev/null || echo "âš ï¸ roms ç›®å½•ä¸å­˜åœ¨"
            exit 1
          fi
          
          echo "âœ… æ‰¾åˆ° ROM æ–‡ä»¶: $ROM_FILE"
          ROM_BASENAME=$(basename "$ROM_FILE")
          
          # å¤‡ä»½åŸå§‹ ROM æ–‡ä»¶ï¼ˆé›†æˆå‰ï¼‰
          ORIGINAL_ROM_BASENAME="${ROM_BASENAME%.*}_original.rom"
          sudo cp "$ROM_FILE" "roms/$ORIGINAL_ROM_BASENAME"
          sudo chmod 644 "roms/$ORIGINAL_ROM_BASENAME"
          sudo chown runner:runner "roms/$ORIGINAL_ROM_BASENAME"
          echo "ğŸ“‹ åŸå§‹ ROM å·²å¤‡ä»½ä¸º: $ORIGINAL_ROM_BASENAME"
          
          # åœ¨ Docker å®¹å™¨å†…æ‰§è¡Œ cbfstool æ“ä½œ
          docker run --rm --user root \
            -v "$(pwd)/coreboot:/home/coreboot/coreboot" \
            -v "$(pwd)/roms:/home/coreboot/roms" \
            -v "$(pwd)/pxerom_files:/home/coreboot/pxerom_files" \
            -w /home/coreboot \
            coreboot/coreboot-sdk:latest \
            /bin/bash -c "
              echo 'ğŸ” å½“å‰ç¯å¢ƒï¼š'
              pwd
              ls -la roms/
              ls -la pxerom_files/
              
              echo ''
              echo 'ğŸ“‹ ROM æ–‡ä»¶ä¿¡æ¯ï¼ˆé›†æˆå‰ï¼‰ï¼š'
              coreboot/build/cbfstool roms/$ROM_BASENAME print
              
              echo ''
              echo 'ğŸ”§ æ·»åŠ  Realtek ç½‘ç»œå¯åŠ¨æ”¯æŒä½œä¸º PCI Option ROM...'
              
              # æ£€æŸ¥ PXE ROM æ–‡ä»¶
              echo 'ğŸ“‹ æ£€æŸ¥ PXE ROM æ–‡ä»¶ï¼š'
              ls -la pxerom_files/
              file pxerom_files/gbe_pxe_rom_2.70.rom
              echo ''
              
              # RTL8111H PCI ID: Vendor=10ec, Device=8168
              # å‘½åæ ¼å¼: pci<vendor>,<device>.rom (coreboot æ ‡å‡†æ ¼å¼)
              
              # å°è¯•æ·»åŠ  GBE PXE ROM ä½œä¸º PCI Option ROM
              echo 'ğŸ”§ å°è¯•æ·»åŠ  PXE ROMï¼ˆ.lom æ–‡ä»¶ + optionrom ç±»å‹ï¼‰...'
              if coreboot/build/cbfstool roms/$ROM_BASENAME add \
                -f pxerom_files/gbe_pxe_rom_2.70.rom \
                -n pci10ec,8168.rom \
                -t optionrom; then
                echo 'âœ… GBE PXE ROM é›†æˆæˆåŠŸï¼ˆ.lom + optionrom ç±»å‹ï¼‰'
              else
                echo 'âŒ .lom + optionrom å¤±è´¥ï¼Œå°è¯• .nic + optionrom...'
                # å°è¯•ä½¿ç”¨ .nic æ–‡ä»¶
                cp pxerom_files/BIN/rtegpxe.nic pxerom_files/gbe_pxe_rom_2.70.nic
                if coreboot/build/cbfstool roms/$ROM_BASENAME add \
                  -f pxerom_files/gbe_pxe_rom_2.70.nic \
                  -n pci10ec,8168.rom \
                  -t optionrom; then
                  echo 'âœ… GBE PXE ROM é›†æˆæˆåŠŸï¼ˆ.nic + optionrom ç±»å‹ï¼‰'
                else
                  echo 'âŒ optionrom ç±»å‹å¤±è´¥ï¼Œå°è¯• raw ç±»å‹...'
                  # å°è¯•ä½œä¸º raw ç±»å‹
                  if coreboot/build/cbfstool roms/$ROM_BASENAME add \
                    -f pxerom_files/gbe_pxe_rom_2.70.nic \
                    -n pci10ec,8168.rom \
                    -t raw; then
                    echo 'âœ… GBE PXE ROM é›†æˆæˆåŠŸï¼ˆ.nic + raw ç±»å‹ï¼‰'
                  else
                    echo 'âŒ æ‰€æœ‰å°è¯•éƒ½å¤±è´¥ï¼Œæ£€æŸ¥æ–‡ä»¶æ ¼å¼å’Œ CBFS ç©ºé—´'
                    echo 'ğŸ“Š CBFS ç©ºé—´ä½¿ç”¨æƒ…å†µï¼š'
                    coreboot/build/cbfstool roms/$ROM_BASENAME print | grep -E '(Size|Comp|empty)'
                    echo 'ğŸ“‹ å°è¯•çš„æ–‡ä»¶ï¼š'
                    ls -la pxerom_files/
                    echo 'ğŸ“‹ æ–‡ä»¶æ ¼å¼æ£€æŸ¥ï¼š'
                    file pxerom_files/gbe_pxe_rom_2.70.rom
                    file pxerom_files/gbe_pxe_rom_2.70.nic
                  fi
                fi
              fi
              
              # é‡å‘½åé›†æˆåçš„ ROM æ–‡ä»¶
              INTEGRATED_ROM_BASENAME=\"${ROM_BASENAME%.*}_with_pxe_rom.rom\"
              mv roms/$ROM_BASENAME roms/\$INTEGRATED_ROM_BASENAME
              
              # è®¾ç½®æƒé™
              chmod 644 roms/\$INTEGRATED_ROM_BASENAME
              chown 1001:1001 roms/\$INTEGRATED_ROM_BASENAME
              
              echo \"âœ… é›†æˆåçš„ ROM å·²é‡å‘½åä¸º: \$INTEGRATED_ROM_BASENAME\"
              
              echo ''
              echo 'ğŸ“‹ ROM æ–‡ä»¶ä¿¡æ¯ï¼ˆé›†æˆåï¼‰ï¼š'
              coreboot/build/cbfstool roms/\$INTEGRATED_ROM_BASENAME print
            "

      - name: ğŸ“¦ éªŒè¯é›†æˆç»“æœ / Verify Integration
        run: |
          echo "ğŸ“¦ éªŒè¯ Realtek 8111 PXE ROM é›†æˆç»“æœ"
          
          # æŸ¥æ‰¾é›†æˆåçš„ ROM æ–‡ä»¶
          INTEGRATED_ROM_FILE=$(ls roms/*_with_pxe_rom.rom | head -1)
          ORIGINAL_ROM_FILE=$(ls roms/*_original.rom | head -1)
          
          if [ -z "$INTEGRATED_ROM_FILE" ]; then
            echo "âŒ æœªæ‰¾åˆ°é›†æˆåçš„ ROM æ–‡ä»¶"
            echo "ğŸ“‹ æ£€æŸ¥ roms ç›®å½•å†…å®¹ï¼š"
            ls -la roms/ 2>/dev/null || echo "âš ï¸ roms ç›®å½•ä¸å­˜åœ¨"
            exit 1
          fi
          
          echo "âœ… æ‰¾åˆ°é›†æˆåçš„ ROM æ–‡ä»¶: $(basename "$INTEGRATED_ROM_FILE")"
          if [ -n "$ORIGINAL_ROM_FILE" ]; then
            echo "âœ… æ‰¾åˆ°åŸå§‹ ROM æ–‡ä»¶: $(basename "$ORIGINAL_ROM_FILE")"
          fi
          
          echo ""
          echo "ğŸ“Š ROM æ–‡ä»¶å¯¹æ¯”ï¼š"
          ls -lh "$INTEGRATED_ROM_FILE"
          if [ -n "$ORIGINAL_ROM_FILE" ]; then
            ls -lh "$ORIGINAL_ROM_FILE"
          fi
          
          ROM_BASENAME=$(basename "$INTEGRATED_ROM_FILE")
          
          # åœ¨ Docker å®¹å™¨å†…éªŒè¯
          docker run --rm --user root \
            -v "$(pwd)/coreboot:/home/coreboot/coreboot" \
            -v "$(pwd)/roms:/home/coreboot/roms" \
            -w /home/coreboot \
            coreboot/coreboot-sdk:latest \
            /bin/bash -c "
              echo 'ğŸ” éªŒè¯ PXE ROM é›†æˆçŠ¶æ€ï¼š'
              echo ''
              
              # æ£€æŸ¥ PCI Option ROM
              if coreboot/build/cbfstool roms/$ROM_BASENAME print | grep -q 'pci10ec,8168.rom'; then
                echo 'âœ… Realtek ç½‘ç»œå¯åŠ¨æ”¯æŒå·²æˆåŠŸé›†æˆåˆ°å›ºä»¶ä¸­'
                echo ''
                echo 'ğŸ“‹ PCI Option ROM è¯¦ç»†ä¿¡æ¯ï¼š'
                coreboot/build/cbfstool roms/$ROM_BASENAME print | grep -A 3 'pci10ec,8168.rom'
                echo ''
                echo 'ğŸ¯ é›†æˆæˆåŠŸï¼å›ºä»¶ç°åœ¨æ”¯æŒï¼š'
                echo '  - RTL8111H ç½‘å¡ç½‘ç»œå¯åŠ¨'
                echo '  - PCI Option ROM è‡ªåŠ¨åŠ è½½'
                echo '  - å…¼å®¹ RTL8168 ç³»åˆ— PXE ROM'
              else
                echo 'âŒ Realtek ç½‘ç»œå¯åŠ¨æ”¯æŒæœªæ‰¾åˆ°ï¼Œå¯èƒ½é›†æˆå¤±è´¥'
                echo ''
                echo 'ğŸ“‹ å®Œæ•´çš„ CBFS å†…å®¹ï¼š'
                coreboot/build/cbfstool roms/$ROM_BASENAME print
                exit 1
              fi
              
              echo ''
              echo 'ğŸ“Š CBFS å®Œæ•´å†…å®¹ï¼š'
              coreboot/build/cbfstool roms/$ROM_BASENAME print
            "
          
          # ç”Ÿæˆæ ¡éªŒå’Œ
          echo ""
          echo "ğŸ” ç”Ÿæˆå›ºä»¶æ ¡éªŒå’Œ..."
          cd roms
          # ä½¿ç”¨ sudo åˆ é™¤æ—§çš„æ ¡éªŒå’Œæ–‡ä»¶
          sudo rm -f *.sha1 *.sha256 2>/dev/null || true
          
          # ä¸ºé›†æˆåçš„ ROM ç”Ÿæˆæ ¡éªŒå’Œ
          sudo bash -c "sha1sum '$(basename "$INTEGRATED_ROM_FILE")' > '$(basename "$INTEGRATED_ROM_FILE").sha1'"
          sudo bash -c "sha256sum '$(basename "$INTEGRATED_ROM_FILE")' > '$(basename "$INTEGRATED_ROM_FILE").sha256'"
          
          # ä¸ºåŸå§‹ ROM ç”Ÿæˆæ ¡éªŒå’Œï¼ˆå¦‚æœå­˜åœ¨ï¼‰
          if [ -n "$ORIGINAL_ROM_FILE" ]; then
            sudo bash -c "sha1sum '$(basename "$ORIGINAL_ROM_FILE")' > '$(basename "$ORIGINAL_ROM_FILE").sha1'"
            sudo bash -c "sha256sum '$(basename "$ORIGINAL_ROM_FILE")' > '$(basename "$ORIGINAL_ROM_FILE").sha256'"
          fi
          
          echo "âœ… æ ¡éªŒå’Œå·²ç”Ÿæˆ"
          echo ""
          echo "ğŸ“Š é›†æˆåçš„ ROM æ ¡éªŒå’Œï¼š"
          cat "$(basename "$INTEGRATED_ROM_FILE").sha1"
          cat "$(basename "$INTEGRATED_ROM_FILE").sha256"
          
          if [ -n "$ORIGINAL_ROM_FILE" ]; then
            echo ""
            echo "ğŸ“Š åŸå§‹ ROM æ ¡éªŒå’Œï¼š"
            cat "$(basename "$ORIGINAL_ROM_FILE").sha1"
            cat "$(basename "$ORIGINAL_ROM_FILE").sha256"
          fi
          cd ..

      - name: ğŸ“ ç”Ÿæˆé›†æˆæŠ¥å‘Š / Generate Integration Report
        run: |
          echo "ğŸ“ ç”Ÿæˆæ–¹æ¡ˆ7é›†æˆæŠ¥å‘Š"
          
          INTEGRATED_ROM_FILE=$(ls roms/*_with_pxe_rom.rom | head -1)
          ORIGINAL_ROM_FILE=$(ls roms/*_original.rom | head -1)
          INTEGRATED_ROM_NAME=$(basename "$INTEGRATED_ROM_FILE")
          ORIGINAL_ROM_NAME=$(basename "$ORIGINAL_ROM_FILE" 2>/dev/null || echo "æœªæ‰¾åˆ°")
          
          cat > integration_report.md << EOF
          # æ–¹æ¡ˆ7 - Realtek 8111 PXE ROM é›†æˆæŠ¥å‘Š
          
          ## ğŸ“‹ æ„å»ºä¿¡æ¯
          
          - **æ„å»ºæ—¥æœŸ**: $(date '+%Y-%m-%d %H:%M:%S')
          - **é›†æˆåå›ºä»¶**: $INTEGRATED_ROM_NAME
          - **é›†æˆåå¤§å°**: $(du -h "$INTEGRATED_ROM_FILE" | cut -f1)
          - **åŸå§‹å›ºä»¶**: $ORIGINAL_ROM_NAME
          - **åŸå§‹å¤§å°**: $(du -h "$ORIGINAL_ROM_FILE" | cut -f1 2>/dev/null || echo "æœªæ‰¾åˆ°")
          - **æ–¹æ¡ˆç±»å‹**: Realtek 8111 PXE ROM é›†æˆ
          
          ## ğŸ¯ æ–¹æ¡ˆè¯´æ˜
          
          ### æŠ€æœ¯å®ç°
          - ä½¿ç”¨ MrChromebox çš„ EDK2 ä½œä¸ºä¸»è¦ payload
          - é›†æˆ Realtek 8111 å®˜æ–¹ PXE ROM ä½œä¸º PCI Option ROM
          - PCI Vendor ID: 0x10ec, Device ID: 0x8168
          - PCI Option ROM å‘½å: pci10ec,8168.rom
          
          ### é¢„æœŸåŠŸèƒ½
          - âœ… ç¡¬ä»¶å±‚é¢å¯ç”¨ç½‘ç»œå¯åŠ¨
          - âœ… BIOS/UEFI è‡ªåŠ¨è¯†åˆ«ç½‘å¡çš„ PXE èƒ½åŠ›
          - âœ… æ— éœ€é¢å¤–é©±åŠ¨æˆ–é…ç½®
          
          ## ğŸ“Š é›†æˆçŠ¶æ€
          
          ### PXE ROM é›†æˆ
          - PXE ROM æ–‡ä»¶: rtl8111_ipxe.efi
          - CBFS è·¯å¾„: pci10ec,8168.rom
          - ç±»å‹: PCI Option ROM
          
          ### éªŒè¯ç»“æœ
          \`\`\`
          $(docker run --rm -v "$(pwd)/coreboot:/home/coreboot/coreboot" -w /home/coreboot coreboot/coreboot-sdk:latest /bin/bash -c "coreboot/build/cbfstool roms/$INTEGRATED_ROM_NAME print | grep -A 3 'pci10ec,8168.rom' || echo 'PXE ROM æœªæ‰¾åˆ°'")
          \`\`\`
          
          ## ğŸ” æ ¡éªŒå’Œ
          
          ### é›†æˆåå›ºä»¶
          **SHA1**:
          \`\`\`
          $(cat "$INTEGRATED_ROM_FILE.sha1" 2>/dev/null || echo "æœªç”Ÿæˆ")
          \`\`\`
          
          **SHA256**:
          \`\`\`
          $(cat "$INTEGRATED_ROM_FILE.sha256" 2>/dev/null || echo "æœªç”Ÿæˆ")
          \`\`\`
          
          ### åŸå§‹å›ºä»¶
          **SHA1**:
          \`\`\`
          $(cat "$ORIGINAL_ROM_FILE.sha1" 2>/dev/null || echo "æœªç”Ÿæˆ")
          \`\`\`
          
          **SHA256**:
          \`\`\`
          $(cat "$ORIGINAL_ROM_FILE.sha256" 2>/dev/null || echo "æœªç”Ÿæˆ")
          \`\`\`
          
          ## ğŸ“ ä½¿ç”¨è¯´æ˜
          
          ### åˆ·å†™å›ºä»¶
          1. ä¸‹è½½å›ºä»¶æ–‡ä»¶å’Œæ ¡éªŒå’Œæ–‡ä»¶
          2. éªŒè¯æ ¡éªŒå’Œç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§
          3. ä½¿ç”¨ flashrom åˆ·å†™å›ºä»¶
          
          ### å¯åŠ¨æµ‹è¯•
          1. åˆ·å†™å›ºä»¶åé‡å¯è®¾å¤‡
          2. è¿›å…¥ BIOS/UEFI è®¾ç½®
          3. æ£€æŸ¥ç½‘ç»œå¯åŠ¨é€‰é¡¹
          4. æµ‹è¯• PXE ç½‘ç»œå¯åŠ¨åŠŸèƒ½
          
          ## ğŸ’¡ æŠ€æœ¯ä¼˜åŠ¿
          
          - â­ **æœ€ç®€å•çš„é›†æˆæ–¹å¼** - åªéœ€æ·»åŠ  PCI Option ROM
          - â­ **å®˜æ–¹æ”¯æŒ** - ä½¿ç”¨ Realtek æˆ– iPXE å®˜æ–¹é©±åŠ¨
          - â­ **ç¡¬ä»¶åŸç”Ÿ** - ä¸ä¾èµ– payload ç½‘ç»œæ ˆ
          - â­ **é«˜å…¼å®¹æ€§** - è‡ªåŠ¨è¯†åˆ«ç½‘å¡å¹¶å¯ç”¨ PXE
          
          ## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”
          
          | ç‰¹æ€§ | æ–¹æ¡ˆ7 (PXE ROM) | æ–¹æ¡ˆ1 (iPXE) | æ–¹æ¡ˆ2 (iPXE Payload) |
          |------|----------------|--------------|---------------------|
          | é›†æˆå¤æ‚åº¦ | â­ æœ€ç®€å• | â­â­â­ ä¸­ç­‰ | â­â­â­â­ å¤æ‚ |
          | å®˜æ–¹æ”¯æŒ | âœ… Realtek/iPXE å®˜æ–¹ | âŒ ç¤¾åŒº | âŒ ç¤¾åŒº |
          | ç½‘ç»œå…¼å®¹æ€§ | âœ… ç¡¬ä»¶åŸç”Ÿ | âš ï¸ ä¾èµ–é©±åŠ¨ | âœ… iPXE é©±åŠ¨ |
          | å¯åŠ¨é€Ÿåº¦ | â­â­â­ å¿« | â­â­ ä¸€èˆ¬ | â­â­ ä¸€èˆ¬ |
          | åŠŸèƒ½ä¸°å¯Œæ€§ | â­â­ åŸºç¡€ PXE | â­â­â­â­â­ é«˜çº§åŠŸèƒ½ | â­â­â­â­â­ é«˜çº§åŠŸèƒ½ |
          
          ## ğŸ”„ åç»­æ”¹è¿›
          
          - [ ] æµ‹è¯•å®é™…ç½‘ç»œå¯åŠ¨åŠŸèƒ½
          - [ ] éªŒè¯ WDS æœåŠ¡å™¨è¿æ¥
          - [ ] æµ‹è¯•ä¸åŒç½‘ç»œç¯å¢ƒ
          - [ ] å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆçš„æ€§èƒ½
          
          ---
          
          **æ„å»ºæ—¶é—´**: $(date '+%Y-%m-%d %H:%M:%S UTC')
          EOF
          
          echo "âœ… é›†æˆæŠ¥å‘Šå·²ç”Ÿæˆ"
          cat integration_report.md

      - name: ä¸Šä¼ å›ºä»¶ / Upload Firmware
        uses: actions/upload-artifact@v4
        with:
          name: coreboot-kaisa-rtl8111-pxerom-${{ github.run_number }}
          path: |
            roms/*.rom
            roms/*.sha1
            roms/*.sha256
            integration_report.md

      - name: åˆ›å»º Release / Create Release
        if: github.event.inputs.release == 'true'
        uses: softprops/action-gh-release@v1
        with:
          tag_name: kaisa-rtl8111-pxerom-${{ github.run_number }}
          name: "Coreboot Kaisa - æ–¹æ¡ˆ7 (RTL8111 PXE ROM) #${{ github.run_number }}"
          body: |
            # ğŸ¯ æ–¹æ¡ˆ7ï¼šRealtek 8111 PXE ROM é›†æˆ
            
            ## ğŸ“‹ æ–¹æ¡ˆè¯´æ˜
            
            - **é›†æˆæ–¹å¼**: Realtek 8111 PXE ROM ä½œä¸º PCI Option ROM
            - **ä¸»æ¿**: Acer Chromebox CXI4 (kaisa)
            - **ç½‘å¡**: Realtek RTL8111H (PCI ID: 10ec:8168)
            - **Payload**: MrChromebox EDK2
            
            ## ğŸ’¡ æŠ€æœ¯ä¼˜åŠ¿
            
            - â­ **æœ€ç®€å•çš„é›†æˆæ–¹å¼** - åªéœ€æ·»åŠ  PCI Option ROM
            - â­ **å®˜æ–¹æ”¯æŒ** - ä½¿ç”¨ Realtek æˆ– iPXE å®˜æ–¹é©±åŠ¨
            - â­ **ç¡¬ä»¶åŸç”Ÿ** - ä¸ä¾èµ– payload ç½‘ç»œæ ˆ
            - â­ **é«˜å…¼å®¹æ€§** - è‡ªåŠ¨è¯†åˆ«ç½‘å¡å¹¶å¯ç”¨ PXE
            
            ## ğŸ” æ–‡ä»¶æ ¡éªŒ
            
            è¯·ä¸‹è½½åéªŒè¯ SHA1/SHA256 æ ¡éªŒå’Œç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§ã€‚
            
            ## ğŸ“ ä½¿ç”¨è¯´æ˜
            
            1. ä¸‹è½½å›ºä»¶æ–‡ä»¶
            2. éªŒè¯æ ¡éªŒå’Œ
            3. ä½¿ç”¨ flashrom åˆ·å†™å›ºä»¶
            4. é‡å¯åè¿›å…¥ BIOS/UEFI è®¾ç½®
            5. æ£€æŸ¥ç½‘ç»œå¯åŠ¨é€‰é¡¹
            6. æµ‹è¯• PXE ç½‘ç»œå¯åŠ¨åŠŸèƒ½
            
            ## âš ï¸ æ³¨æ„äº‹é¡¹
            
            - åˆ·å†™å›ºä»¶å‰è¯·å¤‡ä»½åŸæœ‰å›ºä»¶
            - ç¡®ä¿ç”µæºç¨³å®šï¼Œåˆ·å†™è¿‡ç¨‹ä¸­ä¸è¦æ–­ç”µ
            - å»ºè®®å…ˆåœ¨æµ‹è¯•è®¾å¤‡ä¸ŠéªŒè¯
            
            **æ„å»ºæ—¶é—´**: ${{ github.event.repository.updated_at }}
          files: |
            roms/*.rom
            roms/*.sha1
            roms/*.sha256
            integration_report.md
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}


